#! /bin/sh
SUF=$1
shift
FLAGS=$*
while read n l; do
    ./Geod3Test -e $l $FLAGS < ../test$n.txt > test$n.out$SUF &
    sleep 1
done <<EOF
obl  1 3/4 3 0
seta 1 1   2 1
set  1 3/2 1 2
pro  1 3   0 3
spha 1 0 3 0
sphb 1 0 2 1
sphc 1 0 1 2
sphd 1 0 0 3
hu   1 7577279780/1130005142289 1942065235 6378137
phu  1 30308952520/4489860107041 3178376 971037955
EOF

exit

Problem case for phu:
echo 38 83 -38 -98 | ./Geod3Solve -e  1 30308952520/4489860107041 3178376 971037955 -p 20 -i --debug
3.1293641189285856421 -> 3.12936411894543332
err = 2e-11

set  err      bad-line inverse-problem
phu  151757   357892   38   83 -38 -98 -> -38 82 38 -97
pro  29083732 18182    89    1 -90  89 -> -90  1 89  89
sphd 12622381 400668   41 -179 -42 104 -> -90  1 89  76

These ellipsoids form a series with a/c = 2
obl  1 3/4 3 0
seta 1 1   2 1
set  1 3/2 1 2
pro  1 3   0 3

These ellipsoids form a series with a/c = 1
spha 1 0 3 0
sphb 1 0 2 1
sphc 1 0 1 2
sphd 1 0 0 3

WGS84
A = 6378137;
f = 1/298.257223563;
B approx round(6378137*(1-1/298.257223563)) = 6356752

Earth approximation Panou et al., Hu et al. a-b = 70 = hu
-t A+35 A-35 B
-t 6378172 6378102 6356752
-e 6378102 0.00670552681260463 0.9967265474113045 0.0032734525886955056
-e 6378102 0.006706 0.996727 0.003273
-e 6378102 7577279780/1130005142289 1942065235 6378137

Prolate "equivalent" = phu
-t A B+35 B-35
-t 6378137 6356787 6356717
-e 6356787 0.006750533824532638 0.003262495093607705 0.9967375049063923
-e 6356787 0.006751 0.003262 0.996738
-e 6356787 30308952520/4489860107041 3178376 971037955

p:[e2=(a^2-c^2)/b^2, k2=(b^2-c^2)/(a^2-c^2), kp2 = (a^2-b^2)/(a^2-c^2)];
p,a=6378172,b=6378102,c=6356752;
p,a=6378137,b=6356787,c=6356717;

a^2/c^2=(1+e2*(1-k2))/(1-e2*k2);
e2=(a^2-c^2)/(a^2*k2+c^2*(1-k2));
