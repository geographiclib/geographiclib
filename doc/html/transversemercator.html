<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>GeographicLib: Transverse Mercator Projection</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="transversemercator">Transverse Mercator Projection </a></h1><center> Back to <a class="el" href="organization.html">Code organization</a>. Forward to <a class="el" href="geodesic.html">Geodesics on the Ellipsoid</a>. Up to <a class="el" href="index.html#contents">Contents</a>. </center><p>
<b>NOTE</b> 1: Some of the material in this section has been included in<ul>
<li>Charles F. F. Karney, <a href="http://arxiv.org/abs/1002.1417">Transverse Mercator with an accuracy of a few nanometers,</a> Feb. 2010, <a href="http://arxiv.org/abs/1002.1417">arXiv:1002.1417</a>.</li></ul>
<p>
<b>NOTE</b> 2: The figures in this section are relatively small in order to allow them to be displayed quickly. The "Fig. N" link beneath each figure points to a PDF version of the figure. These are in vector format and allow the figures to be magnified to show the details more clearly.<p>
The primary sources for the material presented here are:<ul>
<li>J. P. Snyder, <a href="http://pubs.er.usgs.gov/usgspubs/pp/pp1395">Map Projections: A Working Manual</a>, USGS Professional Paper 1395 (1987), pp. 48&ndash;66. This contains an overview of the transverse Mercator projection (and many other projections). However, the approximations given for this projection are rather crude. The terminology for the various transverse Mercator map projections is taken form J. P. Snyder, Flattening the Earth (Chicago Univ. Press, 1993).</li><li>L. Kr&uuml;ger, <a href="http://dx.doi.org/10.2312/GFZ.b103-krueger28">Konforme Abbildung des Erdellipsoids in der Ebene</a> (Conformal mapping of the ellipsoidal earth to the plane), Royal Prussian Geodetic Institute, New Series 52, 172 pp. (1912). The derives the series solution for the transverse Mercator projection of an ellipsoid. This gives very good accuracy and this method or an extension of it to higher-order provides the most accurate algorithms for the projection valid in some zone near the central meridian. It is also of interest to see the systematic use of logarithms in the pre-electronic and pre-mechanical age (when computers were human).</li><li><a href="http://www.jhs-suositukset.fi/suomi/jhs154">JHS 154, ETRS89 - j&auml;rjestelm&auml;&auml;n liittyv&auml;t karttaprojektiot, tasokoordinaatistot ja karttalehtijako</a> (Map projections, plane coordinates, and map sheet index for ETRS89), published by JUHTA, Finnish Geodetic Institute, and the National Land Survey of Finland (2006). A concise summary of Kr&uuml;ger's method is given in <a href="http://docs.jhs-suositukset.fi/jhs-suositukset/JHS154/JHS154_liite1.pdf">Appendix 1</a>.</li><li>L. P. Lee, Conformal Projections Based on Elliptic Functions, (B. V. Gutsell, Toronto, 1976), 128pp., ISBN: 0919870163 (Also appeared as: Monograph 16, Suppl. No. 1 to Canadian Cartographer, Vol 13). Part V, pp. 67&ndash;101, <a href="http://dx.doi.org/10.3138/X687-1574-4325-WM62">Conformal Projections Based On Jacobian Elliptic Functions</a>, gives closed form expressions for the transverse Mercator projection based on work by E. H. Thompson (1945). This may be purchased for a modest sum. Other useful sections are Part I, pp. 1&ndash;3 and Part II, pp. 4&ndash;14.</li><li>M. Abramowitz and I. A. Stegun, Handbook of Mathematical Functions (Dover, 1965). This is the bible for special functions. It is easily accessible on the web. Chapter 16 covers elliptic functions and Chapter 17 covers elliptic integrals.</li></ul>
<h2><a class="anchor" name="tmvarious">
Survey of transverse Mercator projections</a></h2>
The following is adapted from Lee (1976) particularly pp. 92&ndash;101. The terminology is from Snyder (1993) pp. 159&ndash;161.<p>
The transverse Mercator projection is a conformal projection of the ellipsoid in which the central meridian is straight. Within these constrains there are various projections that differ in how the scale varies along the central meridian. The simplest such projection from an algorithmic point of view is the Gauss-Schreiber projection which consists of a conformal projection from the ellipsoid to a sphere followed by the spherical transverse Mercator projection. This results in a projection whose scale on the central meridian increases from the equator to the pole (by an amount proportional to the flattening). In the Gauss-Kr&uuml;ger projection, the scale along the central meridian is held constant. This projection is usually expressed as a series which is valid only sufficiently close to the central meridian. (This is implemented by <a class="el" href="classGeographicLib_1_1TransverseMercator.html" title="Transverse Mercator Projection.">GeographicLib::TransverseMercator</a>.) The projection can however be expressed in closed form in terms of the Thompson transverse Mercator projection (where the scale along the central meridian decreases from the equator to the pole by an amount proportional to the flattening). (This method of computing the Gauss-Kr&uuml;ger projection is implemented by <a class="el" href="classGeographicLib_1_1TransverseMercatorExact.html" title="An exact implementation of the Transverse Mercator Projection.">GeographicLib::TransverseMercatorExact</a>.)<p>
The graticules (lines of constant latitude and longitude) for all these projections are shown in Figs. 1&ndash;3. These figures all use an ellipsoid with eccentricity <em>e</em> = 1/10 (inverse flattening = 10 (3 sqrt(11) + 10) = 199.5, i.e., somewhat flatter than the WGS84 ellipsoid) and the projections have all been scaled so that the distance from the equator to the north pole is unity. One eighth of the ellipsoid is shown in these figures, 0<sup>o</sup> &lt;= latitude &lt;= 90<sup>o</sup> and 0<sup>o</sup> &lt;= longitude &lt;= 90<sup>o</sup>. To obtain the graticule for the entire ellipsoid, reflect these figures in <em>x</em> = 0, <em>y</em> = 0, and <em>y</em> = 1. The blue lines show latitude and longitude at multiples of 10<sup>o</sup>. The green lines show 1<sup>o</sup> intervals for longitude in [80, 90] and latitude in [0, 10]. In all three figures, longitude = 0<sup>o</sup> lies on <em>x</em> = 0 and longitude = 90<sup>o</sup> lies on <em>y</em> = 1.<p>
<center> <div align="center">
<img src="gauss-schreiber-graticule-a.png" alt="gauss-schreiber-graticule-a.png">
</div>
 <a href="gauss-schreiber-graticule-a.pdf">Fig. 1</a> </center><br>
 The graticule for the Gauss-Schreiber transverse Mercator projection. The equator lies on <em>y</em> = 0. Compare this with Lee, Fig. 1 (right), which shows the graticule for half a sphere, but note that in his notation <em>x</em> and <em>y</em> have switched meanings. The graticule for the ellipsoid differs from that for a sphere only in that the latitude lines have shifted slightly. (The conformal transformation from an ellipsoid to a sphere merely relabels the lines of latitude.) This projection places the point latitude = 0<sup>o</sup>, longitude = 90<sup>o</sup> at infinity.<p>
<center> <div align="center">
<img src="gauss-krueger-graticule-a.png" alt="gauss-krueger-graticule-a.png">
</div>
 <a href="gauss-krueger-graticule-a.pdf">Fig. 2</a> </center><br>
 The graticule for the Gauss-Kr&uuml;ger transverse Mercator projection. The equator lies on <em>y</em> = 0 for longitude &lt; 81<sup>o</sup>; beyond this, it arcs up to meet <em>y</em> = 1. Compare this with Lee, Fig. 45 (upper), which shows the graticule for the International Ellipsoid. Lee, Fig. 46, shows the graticule for the entire ellipsoid. This projection (like the Thompson projection) projects the ellipsoid to a finite area.<p>
<center> <div align="center">
<img src="thompson-tm-graticule-a.png" alt="thompson-tm-graticule-a.png">
</div>
 <a href="thompson-tm-graticule-a.pdf">Fig. 3</a> </center><br>
 The graticule for the Thompson transverse Mercator projection. The equator lies on <em>y</em> = 0 for longitude &lt; 81<sup>o</sup>; at longitude = 81<sup>o</sup>, it turns by 120<sup>o</sup> and heads for <em>y</em> = 1. Compare this with Lee, Fig. 43, which shows the graticule for the International Ellipsoid. Lee, Fig. 44, shows the graticule for the entire ellipsoid. This projection (like the Gauss-Kr&uuml;ger projection) projects the ellipsoid to a finite area.<p>
Of the three transverse Mercator projections given here the Gauss-Kr&uuml;ger projection is by far the most important. It is the basis of the UTM system. If "transverse Mercator projection" is used without further elaboration, then, nearly always, it refers to the Gauss-Kr&uuml;ger projection.<h2><a class="anchor" name="extend">
Properties far from the central meridian</a></h2>
The divergent behavior of the Gauss-Schreiber projection as latitude = 0<sup>o</sup>, longitude = 90<sup>o</sup> is approached is unsurprising given the behavior of the standard Mercator projection at the poles. On the other hand, the lack of divergence in the Gauss-Kr&uuml;ger projection (and similarly in the Thompson projection) is perhaps puzzling. We explore the behavior more carefully in this section.<p>
Firstly, the Gauss-Kr&uuml;ger projection <em>does</em> have a singularity at latitude = 0<sup>o</sup> and longitude = 90<sup>o</sup>(1 - <em>e</em>), where <em>e</em> is the eccentricity of the ellipsoid. The choice of <em>e</em> = 1/10 for Figs. 1&ndash;3 was made to ensure that one of the graticule lines (longitude = 81<sup>o</sup>) covered this singularly. The singularly is relatively benign. The Thompson projection contains a cube root singularity with causes the corner in the equator. The transformation from Thompson to Gauss-Kr&uuml;ger "repairs" this to lowest order so that there's no kink in the equation. Nevertheless, a weaker singularity remains (causing a discontinuous change in the radius of curvature for the equator). Thus Gauss-Kr&uuml;ger has a branch point at latitude = 0<sup>o</sup> and longitude = 90<sup>o</sup>(1 - <em>e</em>) and the projection is analytic provided this point is avoided. However the results obtained for the projection will depend on which sheet of the projection is used or which route around the branch point is taken.<p>
The "standard" convention for projecting a geographic position is to follow the central meridian from the equator to the target latitude, then to follow the line of constant latitude to the target longitude. This is equivalent to placing two branch cuts on the equator in the longitude ranges +/- [90<sup>o</sup>(1 - <em>e</em>), 90<sup>o</sup>(1 + <em>e</em>)]. For points on equator for |longitude| &gt; 90<sup>o</sup>(1 - <em>e</em>), the path should go to the north of branch point. This convention corresponds to Fig. 2, above, after suitable reflections to cover the ellipsoid and to Lee, Fig. 46.<p>
In order to explore the behavior to the right of the equator in Fig. 2, we define an "extended" domain for the projection, this consists of the union of<ul>
<li>0<sup>o</sup> &lt;= latitude &lt;= 90<sup>o</sup> and 0<sup>o</sup> &lt;= longitude &lt;= 90<sup>o</sup></li><li>-90<sup>o</sup> &lt; latitude &lt;= 0<sup>o</sup> and 90<sup>o</sup>(1 - <em>e</em>) &lt;= longitude &lt;= 90<sup>o</sup></li></ul>
The rule for reaching the second area here is to move on the central meridian to a small positive latitude, move at constant latitude to the target longitude and then to move on a meridian to the target latitude. In this case, the branch cut emanates in a south-westerly direction from the branch point. Following this prescription the range of the projection now consists of the union of<ul>
<li>0 &lt;= <em>x</em> and 0 &lt;= <em>y/</em>(<em>k<sub>0</sub></em> <em>a</em>) &lt;= E(<em>e<sup>2</sup></em>)</li><li>K(1 - <em>e<sup>2</sup></em>) - E(1 - <em>e<sup>2</sup></em>) &lt;= <em>x/</em>(<em>k<sub>0</sub></em> <em>a</em>) and <em>y</em> &lt;= 0</li></ul>
where <em>k<sub>0</sub></em> is the central scale factor, <em>a</em> is the major radius of the ellipsoid, K and E are complete elliptic integrals. Setting the optional argument <em>extendp</em> = true in the constructor for <a class="el" href="classGeographicLib_1_1TransverseMercatorExact.html" title="An exact implementation of the Transverse Mercator Projection.">GeographicLib::TransverseMercatorExact</a> provides access to this extended domain.<p>
Figures 4&ndash;5 illustrate the properties of the Gauss-Kr&uuml;ger transverse Mercator projection in this extended domain. These figures use an ellipsoid with eccentricity 1/10 (as in Figs. 1&ndash;3) and with <em>a</em> = 1/E(0.01) = 0.6382 and <em>k<sub>0</sub></em> = 1. The branch point in this case lies at lat = 0<sup>o</sup>, lon = 81<sup>o</sup> or <em>x</em> = (K(0.99) - E(0.99))/E(0.01) = 1.71, <em>y</em> = 0.<p>
<center> <div align="center">
<img src="gauss-krueger-graticule.png" alt="gauss-krueger-graticule.png">
</div>
<br>
 <a href="gauss-krueger-graticule.pdf">Fig. 4</a> </center> Figure 4 shows the graticule the extended domain. The blue lines show latitude and longitude at multiples of 10<sup>o</sup>. The green lines show 1<sup>o</sup> intervals for longitude in [80, 90] and latitude in [-5, 10].<p>
<center> <div align="center">
<img src="gauss-krueger-convergence-scale.png" alt="gauss-krueger-convergence-scale.png">
</div>
 <a href="gauss-krueger-convergence-scale.pdf">Fig. 5</a> </center><br>
 Figure 5 shows the convergence and scale for the Gauss-Kr&uuml;ger transverse Mercator projection in the extended domain. The blue lines emanating from the top left corner (the north pole) are lines of constant convergence. Convergence = 0<sup>o</sup> is given by the dog-legged line joining the points (0,1), (0,0), (1.71,0), (1.71,-inf). Convergence = 90<sup>o</sup> is given by the line y = 1. The other lines show multiples of 10<sup>o</sup> between 0<sup>o</sup> and 90<sup>o</sup>. The other blue, the green and the black lines show scale = 1 thru 2 at intervals of 0.1, 2 thru 15 at intervals of 1, and 15 thru 35 at intervals of 5. Multiples of 5 are shown in black, multiples of 1 are shown in blue, and the rest are shown in green. Scale = 1 is given by the line segment (0,0) to (0,1). The red line shows the equator between lon = 81<sup>o</sup> and 90<sup>o</sup>. The scale and convergence at the branch point are 1/<em>e</em> = 10 and 0<sup>o</sup>, respectively.<p>
Symmetries in the projection can now be employed to extend the Gauss-Kr&uuml;ger transverse Mercator projection with arbitrary rules for how to circumvent the branch point. The symmetries are equivalent to placing mirrors on the lines segments<ul>
<li>0 &lt;= <em>x</em>, <em>y</em> = 1</li><li><em>x</em> = 0, 0 &lt;= <em>y</em> &lt;= 1</li><li>0 &lt;= <em>x</em> &lt;= 1.71, <em>y</em> = 0</li><li><em>x</em> = 1.71, <em>y</em> &lt;= 0</li></ul>
<p>
In order to understand the projection better, it is instructive to examine the Thompson projection in the extended domain. <center> <div align="center">
<img src="thompson-tm-graticule.png" alt="thompson-tm-graticule.png">
</div>
 <a href="thompson-tm-graticule.pdf">Fig. 6</a> </center><br>
 Figure 6 shows the graticule for the Thompson transverse Mercator projection for the extended domain. The range of the projection is the rectangular region shown<ul>
<li>0 &lt;= <em>u</em> &lt;= K(<em>e<sup>2</sup></em>), 0 &lt;= <em>v</em> &lt;= K(1 - <em>e<sup>2</sup></em>)</li></ul>
The coloring of the lines is the same as Fig. 4, except that latitude lines extended down to -10<sup>o</sup> and a red line has been added showing the line <em>y</em> = 0 for <em>x</em> &gt; 1.71 in the Gauss-Kr&uuml;ger projection (Fig. 4). The extended Thompson projection figure has reflection symmetry on all the four sides of Fig. 6.<p>
In transforming from Thompson to Gauss-Kr&uuml;ger, the right angle at lower right corner of Fig. 6 expands by 3 to 270<sup>o</sup> to produce the outside corner at <em>x</em> = 1.71 and <em>y</em> = 0 in Fig. 4. The top right corner of Fig. 6 represents the south pole and this is transformed to infinity in the extended Gauss-Kr&uuml;ger projection. Despite the apparent similarities, the behaviors of the extended Thompson projection near the north and south poles (top left and top right corners in Fig. 6) are rather different. The singularity for the north pole is merely the result of the singularity of a polar coordinate system (e.g., longitude is undefined at the north pole). Encircling the north pole, causes longitude to increase by 360<sup>o</sup>, as expected. On the other hand, encircling the south pole increases the longitude by 360<sup>o</sup> <em>e</em> = 36<sup>o</sup>. The same behavior is exhibited by the extended Gauss-Kr&uuml;ger projection. The point latitude = -1<sup>o</sup>, longitude = 90<sup>o</sup> projects to a point [2.65,1] in Fig. 4. If we now travel along this latitude line to longitude = 54<sup>o</sup> = 90<sup>o</sup> - 36<sup>o</sup> we arrive back at the same projected position. In the extended domain, the Thompson and the Gauss-Kr&uuml;ger projections are not tightly tied to the globe but can slip around it longitudinally.<h2><a class="anchor" name="testmerc">
Test data for the transverse Mercator projection</a></h2>
A test set for the transverse Mercator projection is available at<ul>
<li><a href="http://sourceforge.net/projects/geographiclib/files/testdata/TMcoords.dat.gz/download">TMcoords.dat.gz</a></li></ul>
This is about 17 MB (compressed). This test set consists of a set of geographic coordinates together with the corresponding transverse Mercator coordinates. The WGS84 ellipsoid is used, with central meridian 0<sup>o</sup>, central scale factor 0.9996 (the UTM value), false easting = false northing = 0 m.<p>
Each line of the test set gives 6 space delimited numbers<ul>
<li>latitude (degrees, exact)</li><li>longitude (degrees, exact &mdash; see below)</li><li>easting (meters, accurate to 0.1 pm)</li><li>northing (meters, accurate to 0.1 pm)</li><li>meridian convergence (degrees, accurate to 10<sup>-18</sup> deg)</li><li>scale (accurate to 10<sup>-20</sup>)</li></ul>
The latitude and longitude are all multiples of 10<sup>-12</sup> deg and should be regarded as exact, except that longitude = 82.63627282416406551 should be interpreted as exactly 90 (1 - <em>e</em>) degrees. These results are computed using Lee's formulas with <a href="http://en.wikipedia.org/wiki/Maxima_(software)">Maxima</a>'s bfloats and fpprec set to 80 (so the errors in the data are probably 1/2 of the values quoted above). The Maxima code, <a href="tm.mac">tm.mac</a> and <a href="ellint.mac">ellint.mac</a>, used to prepare this data set is included in the distribution. You will need to have Maxima installed to use this code. The comments at the top of <a href="tm.mac">tm.mac</a> illustrate how to run it.<p>
The contents of the file are as follows:<ul>
<li>250000 entries randomly distributed in lat in [0, 90], lon in [0, 90];</li><li>1000 entries randomly distributed on lat in [0, 90], lon = 0;</li><li>1000 entries randomly distributed on lat = 0, lon in [0, 90];</li><li>1000 entries randomly distributed on lat in [0, 90], lon = 90;</li><li>1000 entries close to lat = 90 with lon in [0, 90];</li><li>1000 entries close to lat = 0, lon = 0 with lat &gt;= 0, lon &gt;= 0;</li><li>1000 entries close to lat = 0, lon = 90 with lat &gt;= 0, lon &lt;= 90;</li><li>2000 entries close to lat = 0, lon = 90 (1 - <em>e</em>) with lat &gt;= 0;</li><li>25000 entries randomly distributed in lat in [-89, 0], lon in [90 (1 - <em>e</em>), 90];</li><li>1000 entries randomly distributed on lat in [-89, 0], lon = 90;</li><li>1000 entries randomly distributed on lat in [-89, 0], lon = 90 (1 - <em>e</em>);</li><li>1000 entries close to lat = 0, lon = 90 (lat &lt; 0, lon &lt;= 90);</li><li>1000 entries close to lat = 0, lon = 90 (1 - <em>e</em>) (lat &lt; 0, lon &lt;= 90 (1 - <em>e</em>));</li></ul>
(a total of 287000 entries). The entries for lat &lt; 0<sup>o</sup> and lon in [90<sup>o</sup> (1 - <em>e</em>), 90<sup>o</sup>] use the "extended" domain for the transverse Mercator projection explained in <a class="el" href="transversemercator.html#extend">Properties far from the central meridian</a>. The first 258000 entries have lat &gt;= 0<sup>o</sup> and are suitable for testing implementations following the standard convention.<p>
The errors in the forward and reverse projections are converted into a ground distance (e.g., by dividing the error in the projection by the scale factor). The errors in the convergence and in the scale may be large because these quantities vary rapidly near singular points (for convergence at the lat = 90<sup>o</sup> and for both convergence and scale at lat = 0<sup>o</sup>, lon = 90<sup>o</sup> (1 - <em>e</em>)). We account for this by expressing the error as the sum of a constant and a term proportional to the gradient of the quantity being measured.<h2><a class="anchor" name="tmerrors">
Accuracy of transverse Mercator projection</a></h2>
Errors in <a class="el" href="classGeographicLib_1_1TransverseMercatorExact.html" title="An exact implementation of the Transverse Mercator Projection.">GeographicLib::TransverseMercatorExact</a>. For both Forward and Reverse projections<ul>
<li>error in position &lt; 9 nm (5 pm for long doubles)</li></ul>
These errors apply with the standard convention for the transverse Mercator projection. In this case, we use only test samples with non-negative values of latitude.<p>
For the extended transverse Mercator projection (Fig. 4), the errors given above apply only for latitude &gt;= -15<sup>o</sup>. For more negative latitudes, the errors become large. For example for latitude &gt;= -58<sup>o</sup>, the maximum error is 1 mm (and the scale has become 124 million). This increase in the error is due to the use of the Thompson projection in the computation. Looking at the graticule for this projection (Fig. 6), we see that the Thompson scale becomes small close to the south pole resulting in errors (measured as a ground distance) which diverges (the errors vary inversely with scale). For example at lat = -58<sup>o</sup>, the scale for the Thompson projection is about 240000 times smaller than on the central meridian and the errors have increased by about the same factor. If necessary, this problem could be avoided by reformulating the Thompson projection to place the origin at the South pole.<p>
If <a class="el" href="classGeographicLib_1_1TransverseMercatorExact.html" title="An exact implementation of the Transverse Mercator Projection.">GeographicLib::TransverseMercatorExact</a> is modified to use long doubles (a 64-bit floating fraction) instead of of doubles (53-bit floating fraction) then the error in the position is about 5 pm, for latitude &gt;= -15<sup>o</sup>.<p>
Errors in <a class="el" href="classGeographicLib_1_1TransverseMercator.html" title="Transverse Mercator Projection.">GeographicLib::TransverseMercator</a>. For both Forward and Reverse projections within 3900 km using the 6th-order series (TM_TX_MAXPOW = 6, the default)<ul>
<li>error in position &lt; 5 nm</li></ul>
Further from the central meridian, the errors grow rapidly. For |<em>x|</em> = 10700 km (approx 68<sup>o</sup> from the central median), the error in position is about 1 mm. When used in the UTM system, <em>x</em> is typically restricted to |<em>x|</em> &lt;= 500 km. Within |<em>x|</em> &lt;= 500 km, the errors using the 6th-order series are dominated by round-off rather than the number of terms. If <a class="el" href="classGeographicLib_1_1TransverseMercator.html" title="Transverse Mercator Projection.">GeographicLib::TransverseMercator</a> is modified to use long double instead of double, the error in the position within the the UTM region is about 2 pm.<p>
If <a class="el" href="classGeographicLib_1_1TransverseMercator.html" title="Transverse Mercator Projection.">GeographicLib::TransverseMercator</a> is compiled with TM_TX_MAXPOW = 4 to give the 4th-order approximation, then the error is about 210 nm for |<em>x|</em> &lt;= 500 km (the region used for UTM coordinates).<h2><a class="anchor" name="tmseries">
Series approximation for transverse Mercator</a></h2>
Kr&uuml;ger (1912) gives a 4th-order approximation to the transverse Mercator projection. The method entails performing first a Gauss-Schreiber projection and approximating the warp of this to Gauss-Kr&uuml;ger projection as a series in <em>n</em> = (<em>a</em> - <em>b</em>)/(<em>a</em> + <em>b</em>). This is accurate to about 200 nm within the UTM domain. Here we present the series extended to 10th order. The series expanded to order <em>n</em><sup>30</sup> are given in <a href="tmseries30.html">tmseries30.html</a>.<p>
By default, <a class="el" href="classGeographicLib_1_1TransverseMercator.html" title="Transverse Mercator Projection.">GeographicLib::TransverseMercator</a> uses the 6th-order approximation. The preprocessor variable TM_TX_MAXPOW can be used to select an order from 4 thru 8.<p>
In the formulas below ^ indicates exponentiation (<em>n^3</em> = <em>n*<em>n*<em>n</em>)</em> and</em> / indicates real division (3/5 = 0.6). The equations need to be converted to Horner form, but are here left in expanded form so that they can be easily truncated to lower order in <em>n</em>. Some of the integers here are not representable as 32-bit integers and will need to be included as double literals.<p>
<em>A</em> in Kr&uuml;ger, p. 12, eq. (5) <div class="fragment"><pre class="fragment">
  A = a/(n + 1) * (1 + 1/4 * n^2
                     + 1/64 * n^4
                     + 1/256 * n^6
                     + 25/16384 * n^8
                     + 49/65536 * n^10);
</pre></div><p>
<em>gamma</em> in Kr&uuml;ger, p. 21, eq. (41) <div class="fragment"><pre class="fragment">
alpha[1] =   1/2 * n
           - 2/3 * n^2
           + 5/16 * n^3
           + 41/180 * n^4
           - 127/288 * n^5
           + 7891/37800 * n^6
           + 72161/387072 * n^7
           - 18975107/50803200 * n^8
           + 60193001/290304000 * n^9
           + 134592031/1026432000 * n^10;
alpha[2] =   13/48 * n^2
           - 3/5 * n^3
           + 557/1440 * n^4
           + 281/630 * n^5
           - 1983433/1935360 * n^6
           + 13769/28800 * n^7
           + 148003883/174182400 * n^8
           - 705286231/465696000 * n^9
           + 1703267974087/3218890752000 * n^10;
alpha[3] =   61/240 * n^3
           - 103/140 * n^4
           + 15061/26880 * n^5
           + 167603/181440 * n^6
           - 67102379/29030400 * n^7
           + 79682431/79833600 * n^8
           + 6304945039/2128896000 * n^9
           - 6601904925257/1307674368000 * n^10;
alpha[4] =   49561/161280 * n^4
           - 179/168 * n^5
           + 6601661/7257600 * n^6
           + 97445/49896 * n^7
           - 40176129013/7664025600 * n^8
           + 138471097/66528000 * n^9
           + 48087451385201/5230697472000 * n^10;
alpha[5] =   34729/80640 * n^5
           - 3418889/1995840 * n^6
           + 14644087/9123840 * n^7
           + 2605413599/622702080 * n^8
           - 31015475399/2583060480 * n^9
           + 5820486440369/1307674368000 * n^10;
alpha[6] =   212378941/319334400 * n^6
           - 30705481/10378368 * n^7
           + 175214326799/58118860800 * n^8
           + 870492877/96096000 * n^9
           - 1328004581729009/47823519744000 * n^10;
alpha[7] =   1522256789/1383782400 * n^7
           - 16759934899/3113510400 * n^8
           + 1315149374443/221405184000 * n^9
           + 71809987837451/3629463552000 * n^10;
alpha[8] =   1424729850961/743921418240 * n^8
           - 256783708069/25204608000 * n^9
           + 2468749292989891/203249958912000 * n^10;
alpha[9] =   21091646195357/6080126976000 * n^9
           - 67196182138355857/3379030566912000 * n^10;
alpha[10]=   77911515623232821/12014330904576000 * n^10;
</pre></div><p>
<em>beta</em> in Kr&uuml;ger, p. 18, eq. (26*) <div class="fragment"><pre class="fragment">
 beta[1] =   1/2 * n
           - 2/3 * n^2
           + 37/96 * n^3
           - 1/360 * n^4
           - 81/512 * n^5
           + 96199/604800 * n^6
           - 5406467/38707200 * n^7
           + 7944359/67737600 * n^8
           - 7378753979/97542144000 * n^9
           + 25123531261/804722688000 * n^10;
 beta[2] =   1/48 * n^2
           + 1/15 * n^3
           - 437/1440 * n^4
           + 46/105 * n^5
           - 1118711/3870720 * n^6
           + 51841/1209600 * n^7
           + 24749483/348364800 * n^8
           - 115295683/1397088000 * n^9
           + 5487737251099/51502252032000 * n^10;
 beta[3] =   17/480 * n^3
           - 37/840 * n^4
           - 209/4480 * n^5
           + 5569/90720 * n^6
           + 9261899/58060800 * n^7
           - 6457463/17740800 * n^8
           + 2473691167/9289728000 * n^9
           - 852549456029/20922789888000 * n^10;
 beta[4] =   4397/161280 * n^4
           - 11/504 * n^5
           - 830251/7257600 * n^6
           + 466511/2494800 * n^7
           + 324154477/7664025600 * n^8
           - 937932223/3891888000 * n^9
           - 89112264211/5230697472000 * n^10;
 beta[5] =   4583/161280 * n^5
           - 108847/3991680 * n^6
           - 8005831/63866880 * n^7
           + 22894433/124540416 * n^8
           + 112731569449/557941063680 * n^9
           - 5391039814733/10461394944000 * n^10;
 beta[6] =   20648693/638668800 * n^6
           - 16363163/518918400 * n^7
           - 2204645983/12915302400 * n^8
           + 4543317553/18162144000 * n^9
           + 54894890298749/167382319104000 * n^10;
 beta[7] =   219941297/5535129600 * n^7
           - 497323811/12454041600 * n^8
           - 79431132943/332107776000 * n^9
           + 4346429528407/12703122432000 * n^10;
 beta[8] =   191773887257/3719607091200 * n^8
           - 17822319343/336825216000 * n^9
           - 497155444501631/1422749712384000 * n^10;
 beta[9] =   11025641854267/158083301376000 * n^9
           - 492293158444691/6758061133824000 * n^10;
 beta[10]=   7028504530429621/72085985427456000 * n^10;
</pre></div><p>
The following table gives the truncation error when the series above are truncated to order <em>n<sup><em>J</em></sup></em>. The error is the maximum of the errors for the forward and reverse projections, converted in both cases to a true distance (in meters). It is expressed as a function of the geodesic distance (in km) from the central meridian. This table was computed for the WGS84 ellipsoid. When implementing with floating point arithmetic on a computer, there is an additional rounding error incurred; this adds 2.2 m for floats, 4.9 nm for doubles and 2.0 pm for long doubles. <div class="fragment"><pre class="fragment">
dist J=2     J=4     J=5     J=6     J=7     J=8     J=10    J=12
   0 3.0e-02 1.9e-07 5.9e-10 1.7e-12 6.6e-15 2.4e-17 3.5e-22 5.6e-27
 500 3.2e-02 2.1e-07 7.3e-10 2.4e-12 9.4e-15 3.7e-17 6.6e-22 1.3e-26
1000 3.7e-02 3.1e-07 1.2e-09 4.8e-12 2.1e-14 9.8e-17 2.3e-21 5.9e-26
1500 4.7e-02 5.3e-07 2.4e-09 1.1e-11 5.8e-14 3.1e-16 9.4e-21 3.2e-25
2000 6.3e-02 1.0e-06 5.3e-09 2.9e-11 1.7e-13 1.0e-15 4.3e-20 1.9e-24
2500 8.8e-02 2.1e-06 1.2e-08 8.0e-11 5.4e-13 3.8e-15 2.1e-19 1.3e-23
3000 1.3e-01 4.5e-06 3.1e-08 2.3e-10 1.9e-12 1.5e-14 1.2e-18 9.9e-23
3500 1.9e-01 9.6e-06 8.0e-08 7.2e-10 6.8e-12 6.8e-14 7.3e-18 8.6e-22
4000 3.0e-01 2.1e-05 2.2e-07 2.4e-09 2.7e-11 3.2e-13 5.0e-17 8.6e-21
4500 4.7e-01 5.0e-05 6.2e-07 8.3e-09 1.2e-10 1.7e-12 3.9e-16 1.0e-19
5000 7.7e-01 1.3e-04 1.9e-06 3.2e-08 5.5e-10 9.9e-12 3.5e-15 1.4e-18
5500 1.3e+00 3.4e-04 6.6e-06 1.4e-07 3.0e-09 6.8e-11 3.8e-14 2.3e-17
6000 2.4e+00 1.0e-03 2.6e-05 6.8e-07 1.9e-08 5.6e-10 5.2e-13 5.3e-16
6500 4.7e+00 3.6e-03 1.2e-04 4.1e-06 1.5e-07 5.9e-09 9.6e-12 1.7e-14
7000 1.0e+01 1.5e-02 6.6e-04 3.2e-05 1.6e-06 8.7e-08 2.7e-10 9.1e-13
7500 2.5e+01 7.7e-02 5.0e-03 3.5e-04 2.6e-05 2.0e-06 1.3e-08 9.4e-11
8000 7.6e+01 5.7e-01 5.9e-02 6.5e-03 7.6e-04 9.2e-05 1.5e-06 2.6e-08
8500 3.3e+02 8.0e+00 1.5e+00 2.9e-01 5.9e-02 1.3e-02 6.3e-04 3.4e-05
9000 2.9e+03 3.9e+02 1.6e+02 7.4e+01 3.5e+01 1.7e+01 4.4e+00 1.2e+00
</pre></div><p>
<center> <div align="center">
<img src="gauss-krueger-error.png" alt="gauss-krueger-error.png">
</div>
 <a href="gauss-krueger-error.pdf">Fig. 7</a> </center><br>
 The truncation error for the series for the Gauss-Kr&uuml;ger transverse Mercator projection. The blue curves show the truncation error for the order of the series <em>J</em> = 2 (top) thru <em>J</em> = 12 (bottom). The red curves show the combined truncation and round-off errors for<ul>
<li>float and <em>J</em> = 4 (top)</li><li>double and <em>J</em> = 6 (middle)</li><li>long double and <em>J</em> = 8 (bottom)</li></ul>
<p>
The high-order expansions for <em>alpha</em> and <em>beta</em> were produced by the Maxima program <a href="tmseries.mac">tmseries.mac</a> (included in the distribution). To run, start Maxima and enter <div class="fragment"><pre class="fragment">
  load("tmseries.mac")$
</pre></div> Further instructions are included at the top of the file.<p>
<center> Back to <a class="el" href="organization.html">Code organization</a>. Forward to <a class="el" href="geodesic.html">Geodesics on the Ellipsoid</a>. Up to <a class="el" href="index.html#contents">Contents</a>. </center> </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Feb 8 13:32:39 2010 for GeographicLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
